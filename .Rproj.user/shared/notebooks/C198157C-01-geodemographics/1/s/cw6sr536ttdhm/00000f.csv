"0","#| label: geo-elbows-and-plots"
"0","#| warnings: FALSE"
"0","#| message: FALSE"
"0","#| cache: FALSE"
"0","#| tidy: TRUE"
"0",""
"0","# create empty list to store the within sum of square values "
"0","wss_values <- list()"
"0",""
"0","# execute a k-means clustering for k=1, k=2, ..., k=15"
"0","for (i in 1:15) {"
"0","  wss_values[i] <- sum(kmeans(cluster_data,centers=i,iter.max=30)$withinss)"
"0","}"
"0",""
"0","# inspect"
"0","wss_values"
"1","[[1]]
"
"1","[1]"
"1"," 144143"
"1","
"
"1","
"
"1","[[2]]
"
"1","[1]"
"1"," 110934.1"
"1","
"
"1","
"
"1","[[3]]
"
"1","[1]"
"1"," 94944.45"
"1","
"
"1","
"
"1","[[4]]
"
"1","[1]"
"1"," 82701.63"
"1","
"
"1","
"
"1","[[5]]
"
"1","[1]"
"1"," 73974.93"
"1","
"
"1","
"
"1","[[6]]
"
"1","[1]"
"1"," 69127.41"
"1","
"
"1","
"
"1","[[7]]
"
"1","[1]"
"1"," 64459.49"
"1","
"
"1","
"
"1","[[8]]
"
"1","[1]"
"1"," 61503.2"
"1","
"
"1","
"
"1","[[9]]
"
"1","[1]"
"1"," 55936.7"
"1","
"
"1","
"
"1","[[10]]
"
"1","[1]"
"1"," 53316.6"
"1","
"
"1","
"
"1","[[11]]
"
"1","[1]"
"1"," 51383.22"
"1","
"
"1","
"
"1","[[12]]
"
"1","[1]"
"1"," 50770.62"
"1","
"
"1","
"
"1","[[13]]
"
"1","[1]"
"1"," 48257.9"
"1","
"
"1","
"
"1","[[14]]
"
"1","[1]"
"1"," 46980.79"
"1","
"
"1","
"
"1","[[15]]
"
"1","[1]"
"1"," 45846.75"
"1","
"
"1","
"
"0","# vector to dataframe"
"0","wss_values <- as.data.frame(wss_values)"
"0",""
"0","# transpose"
"0","wss_values <- as.data.frame(t(wss_values))"
"0",""
"0","# add cluster numbers"
"0","wss_values$cluster <- seq.int(nrow(wss_values))"
"0","names(wss_values) <- c('wss','cluster')"
"0",""
"0","# plot using ggplot2"
"0","ggplot(data=wss_values, aes(x=cluster,y=wss)) +"
"0","  geom_point() +"
"0","  geom_path() + "
"0","  scale_x_continuous(breaks=seq(1,15)) +"
"0","  xlab('number of clusters') +"
"0","  ylab('within sum of squares')"
