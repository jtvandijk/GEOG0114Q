"0","#| label: geo-run-that-cluster"
"0","#| warnings: FALSE"
"0","#| message: FALSE"
"0","#| cache: FALSE"
"0","#| tidy: TRUE"
"0",""
"0","# create empty list to store the results of the clustering"
"0","clusters <- list()"
"0",""
"0","# create empty variable to store fit"
"0","fit <- NA"
"0","  "
"0","# run the k-means 10 times"
"0","for (i in 1:10){"
"0","  "
"0","  # keep track of the runs"
"0","  print(paste0('starting run: ', i))"
"0","  "
"0","  # run the k-means clustering algorithm to extract 7 clusters"
"0","  clust7 <- kmeans(x=cluster_data, centers=7, iter.max=1000000, nstart=1)"
"0","  "
"0","  # get the total within sum of squares for the run and "
"0","  fit[i] <- clust7$tot.withinss"
"0","  "
"0","  # update the results of the clustering if the total within sum of squares for the run"
"0","  # is lower than any of the runs that have been executed so far "
"0","  if (fit[i] < min(fit[1:(i-1)])){"
"0","    clusters <- clust7}"
"0","}"
"1","[1]"
"1"," ""starting run: 1"""
"1","
"
"1","[1]"
"1"," ""starting run: 2"""
"1","
"
"1","[1]"
"1"," ""starting run: 3"""
"1","
"
"1","[1]"
"1"," ""starting run: 4"""
"1","
"
"1","[1]"
"1"," ""starting run: 5"""
"1","
"
"1","[1]"
"1"," ""starting run: 6"""
"1","
"
"1","[1]"
"1"," ""starting run: 7"""
"1","
"
"1","[1]"
"1"," ""starting run: 8"""
"1","
"
"1","[1]"
"1"," ""starting run: 9"""
"1","
"
"1","[1]"
"1"," ""starting run: 10"""
"1","
"
"0","# inspect"
"0","clusters"
"1","K-means clustering with "
"1",""
"1","7"
"1",""
"1"," clusters of sizes "
"1",""
"1","2050, 1106, 2040, 742, 1814, 542, 186"
"1",""
"1","
"
"1","
Cluster means:
"
"1"," "
"1","    age0to4pc"
"1","  age5to14pc"
"1"," age16to24pc"
"1"," age25to44pc"
"1"," age45to64pc"
"1"," age75pluspc"
"1","
"
"1"," "
"1"," 1_higher_managerial"
"1"," 2_lower_managerial"
"1"," 3_intermediate_occupations"
"1"," 4_employers_small_org"
"1","
"
"1"," "
"1"," 5_lower_supervisory"
"1"," 6_semi_routine"
"1","  7_routine"
"1"," 8_unemployed"
"1"," avg_dwn_speed"
"1"," avb_superfast"
"1","
"
"1"," "
"1"," no_decent_bband"
"1","
"
"1"," [ reached getOption(""max.print"") -- omitted 7 rows ]
"
"1","
Clustering vector:
"
"1"," [1]"
"1"," 4"
"1"," 2"
"1"," 3"
"1"," 3"
"1"," 2"
"1"," 2"
"1"," 2"
"1"," 2"
"1"," 2"
"1"," 3"
"1"," 3"
"1"," 2"
"1"," 2"
"1"," 2"
"1"," 2"
"1","
"
"1"," [ reached getOption(""max.print"") -- omitted 8465 entries ]
"
"1","
Within cluster sum of squares by cluster:
"
"1","[1]"
"1"," 11694.290"
"1","  9424.341"
"1"," 11489.776"
"1","  7818.855"
"1"," 12856.939"
"1","  6277.839"
"1","  3401.821"
"1","
"
"1"," (between_SS / total_SS =  56.3 %)
"
"1","
"
"1","Available components:
"
"1","
"
"1","[1]"
"1"," ""cluster""     "
"1"," ""centers""     "
"1"," ""totss""       "
"1"," ""withinss""    "
"1"," ""tot.withinss"""
"1","
"
"1","[6]"
"1"," ""betweenss""   "
"1"," ""size""        "
"1"," ""iter""        "
"1"," ""ifault""      "
"1","
"
"0","# inspect"
"0","fit"
"1"," [1]"
"1"," 64456.73"
"1"," 64459.49"
"1"," 62963.86"
"1"," 62975.20"
"1"," 65446.64"
"1"," 64456.74"
"1"," 64456.74"
"1"," 62964.98"
"1"," 62975.20"
"1","
"
"1","[10]"
"1"," 64459.54"
"1","
"
